<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Avatar Issue - Crypto Force</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #121212;
            color: white;
            padding: 20px;
            line-height: 1.6;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        .section {
            background: #1a1a1a;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            border: 1px solid #333;
        }
        .error { color: #ff6b6b; }
        .success { color: #51cf66; }
        .warning { color: #ffd43b; }
        .info { color: #74c0fc; }
        button {
            background: #ec4d58;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #d43d48; }
        pre {
            background: #0a0a0a;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç Debug Avatar Issue - Crypto Force</h1>
        
        <div class="section">
            <h2>üìä Current localStorage Data</h2>
            <button onclick="checkLocalStorage()">Check localStorage</button>
            <div id="localStorageData"></div>
        </div>

        <div class="section">
            <h2>üë§ User Authentication Status</h2>
            <button onclick="checkAuthStatus()">Check Auth Status</button>
            <div id="authStatus"></div>
        </div>

        <div class="section">
            <h2>üñºÔ∏è Avatar Data Analysis</h2>
            <button onclick="checkAvatarData()">Check Avatar Data</button>
            <div id="avatarData"></div>
        </div>

        <div class="section">
            <h2>üßπ Cleanup Actions</h2>
            <button onclick="clearAvatarData()">Clear Avatar Data</button>
            <button onclick="clearAllUserData()">Clear All User Data</button>
            <button onclick="resetAuthState()">Reset Auth State</button>
            <div id="cleanupResults"></div>
        </div>

        <div class="section">
            <h2>üìã Instructions</h2>
            <ol>
                <li><strong>Check localStorage:</strong> See what user data is stored locally</li>
                <li><strong>Check Auth Status:</strong> Verify current authentication state</li>
                <li><strong>Check Avatar Data:</strong> Analyze avatar-related information</li>
                <li><strong>Cleanup:</strong> Clear shared data that might cause avatar conflicts</li>
            </ol>
        </div>
    </div>

    <script>
        function checkLocalStorage() {
            const data = {};
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                data[key] = localStorage.getItem(key);
            }
            
            document.getElementById('localStorageData').innerHTML = `
                <h3>localStorage Contents:</h3>
                <pre>${JSON.stringify(data, null, 2)}</pre>
            `;
        }

        function checkAuthStatus() {
            const authData = {
                'crypto-force-user-email': localStorage.getItem('crypto-force-user-email'),
                'crypto-force-logged-out': localStorage.getItem('crypto-force-logged-out'),
                'user-avatar': localStorage.getItem('user-avatar'),
                'user-data': localStorage.getItem('user-data')
            };
            
            document.getElementById('authStatus').innerHTML = `
                <h3>Authentication Status:</h3>
                <pre>${JSON.stringify(authData, null, 2)}</pre>
            `;
        }

        function checkAvatarData() {
            const avatarData = {
                'user-avatar': localStorage.getItem('user-avatar'),
                'avatar-preview': localStorage.getItem('avatar-preview'),
                'current-avatar': localStorage.getItem('current-avatar'),
                'avatar-url': localStorage.getItem('avatar-url')
            };
            
            // Check for any avatar-related keys
            const avatarKeys = [];
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key && key.toLowerCase().includes('avatar')) {
                    avatarKeys.push(key);
                }
            }
            
            document.getElementById('avatarData').innerHTML = `
                <h3>Avatar Data:</h3>
                <pre>${JSON.stringify(avatarData, null, 2)}</pre>
                <h3>All Avatar-related Keys:</h3>
                <pre>${JSON.stringify(avatarKeys, null, 2)}</pre>
            `;
        }

        function clearAvatarData() {
            const avatarKeys = ['user-avatar', 'avatar-preview', 'current-avatar', 'avatar-url'];
            let cleared = [];
            
            avatarKeys.forEach(key => {
                if (localStorage.getItem(key)) {
                    localStorage.removeItem(key);
                    cleared.push(key);
                }
            });
            
            document.getElementById('cleanupResults').innerHTML = `
                <div class="success">‚úÖ Cleared avatar data: ${cleared.join(', ')}</div>
            `;
        }

        function clearAllUserData() {
            const userKeys = [
                'crypto-force-user-email',
                'crypto-force-logged-out',
                'user-avatar',
                'user-data',
                'avatar-preview',
                'current-avatar',
                'avatar-url'
            ];
            
            let cleared = [];
            userKeys.forEach(key => {
                if (localStorage.getItem(key)) {
                    localStorage.removeItem(key);
                    cleared.push(key);
                }
            });
            
            document.getElementById('cleanupResults').innerHTML = `
                <div class="success">‚úÖ Cleared all user data: ${cleared.join(', ')}</div>
            `;
        }

        function resetAuthState() {
            localStorage.clear();
            sessionStorage.clear();
            
            document.getElementById('cleanupResults').innerHTML = `
                <div class="success">‚úÖ Completely reset authentication state</div>
            `;
        }

        // Auto-run on page load
        window.onload = function() {
            checkLocalStorage();
            checkAuthStatus();
            checkAvatarData();
        };
    </script>
</body>
</html>
